{% extends "public/base.html" %}
{% block content %}
<section class="first-section overlay"
         style="background-image: url({{ url_for('static', filename='public/img/Untitled-20.jpg') }})">
    <div class="container">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <a href="{{ url_for('public.main_page') }}">Главная</a>
                </li>
                <li>
                    Магазин
                </li>
            </ul>
        </div>
        <div class="row align-items-center justify-content-center">
            <h1>Каталог продукции</h1>
        </div>
    </div>
</section>
<section class="production">
    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-12">
                <div class="production__filter">
                    <div class="row">
                        <div class="col-lg-7">
                            <div class="row align-items-center">
                                <div class="col-lg-3">
                                    <div class="production__filter_title">
                                        <p>Фильтр</p>
                                        <i class="nut-icon icons-settings"></i>
                                    </div>
                                </div>
                                <div class="col-lg-5">
                                    <select name="product_status" id="product_status">
                                        <option value="all">Все</option>
                                        <option value="new">Новые</option>
                                        <option value="promo">Акционные</option>
                                    </select>
                                </div>
                                <div class="col-lg-4">
                                    <select name="weight" id="weight">
                                        <option value="all">Все</option>
                                        <option value="<40">Меньше 40 граммов</option>
                                        <option value=">40">Больше 40 граммов</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5 align-self-center">
                            <div class="row">
                                <div class="col-lg-5 align-self-center">
                                    <div class="production__filter_price">
                                            <span>
                                                Стоимость
                                            </span>
                                        <i class="nut-icon icons-arrow-down" id="icons-arrow-down"></i>
                                        <i class="nut-icon icons-right-top accent" id="icons-right-top"></i>
                                        <input type="checkbox" id="price_up" style="display: none;">
                                        <input type="checkbox" id="price_down" style="display: none;">
                                    </div>
                                </div>
                                <div class="col-lg-7">
                                    <div class="production__filter_button">
                                        <button type="button" class="button" id="confirm_filter">Применить</button>
                                        <a href="{{ url_for('public.shop_page') }}" class="button_close"><i
                                                class="nut-icon icons-close-button"></i><span> Сбросить</span></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center items_row">
            <div class="col-lg-4 col-md-6 col-12 product_base" style="display: none;">
                <div class="wrap">
                    <div class="production__item">
                        <div class="products-container swiper-container">
                            <!-- Additional required wrapper -->
                            <div class="swiper-wrapper">
                                <!-- Slides -->
                                <div class="swiper-slide gallery_base">
                                    <a href="#"><img src="" alt="alt"/></a>
                                </div>
                            </div>
                            <!-- If we need navigation buttons -->
                            <div class="swiper-button-prev"></div>
                            <div class="swiper-button-next"></div>
                            <img class="zoom" src="{{ url_for('static', filename='public/img/zoom.svg') }}" alt="alt">
                        </div>
                        <div class="wrap">
                            <div class="production__item_title">
                            </div>
                            <div class="production__item_art">
                                <span>Арт:</span> <span class="apt"></span>
                            </div>
                            <div class="production__item_descr">
                            </div>
                            <div class="production__item_weight">
                                <div class="weight_item">
                                    <div class="weight_item_icon">
                                        <i class="nut-icon icons-food-scale-tool"></i>
                                    </div>
                                    <div class="weight_item_descr">
                                        <p>Масса</p>
                                        <p><span class="weight"><i>г.</i></span></p>
                                    </div>
                                </div>
                                <div class="weight_item">
                                    <div class="weight_item_icon">
                                        <i class="nut-icon icons-group"></i>
                                    </div>
                                    <div class="weight_item_descr">
                                        <p>Упаковка</p>
                                        <p><span>вакуумная</span></p>
                                    </div>
                                </div>
                            </div>
                            <div class="production__item_sum">
                                <div class="sum_item">
                                    <div class="sum_item_title">
                                        <p>Цена: </p>
                                    </div>
                                    <div class="sum_item_new">
                                        <p><span class="sum_new"></span> <i>грн.</i></p>
                                    </div>
                                    <div class="sum_item_old">
                                        <p><span class="sum_old"></span> <i>грн.</i></p>
                                    </div>
                                </div>
                                <div class="sum_item">
                                    <div class="sum_item_button">
                                        <a href="#" class="button">Купить</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="wrapper">
                <button type="button" class="button button_transparent" id="more_items">Загрузить ещё</button>
            </div>
        </div>
    </div>
</section>
<section class="manufacturer gray_section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-5">
                <h2>Экологически чистый грецкий орех</h2>
                <div class="wrapper">
                    <h3>Оптом, и в розницу</h3>
                    <p>Сельскохозяйственный обслуживающий кооператив “Орех Причерноморья” выращивает смешанные сады
                        ореха грецкого с фундуком, а также ореха грецкого с шиповником, на площади более 150
                        гектаров.</p>
                    <p>Помимо этого кооператив занимается выращиванием посадочного материала, саженцов привитого и
                        непривитого грецкого ореха, фундука и шиповника.</p>
                    <p>Орех Причерноморья – это первый и единственный в Украине сад по совместному выращиванию фундука и
                        грецкого ореха</p>
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus voluptatem dolorum ab
                        aliquid fugit repellendus, earum eius illum ex, asperiores similique nulla molestias praesentium
                        quos corrupti quas odio temporibus? Voluptatibus!</p>
                </div>
            </div>
            <div class="col-md-7">
                <!-- Swiper -->
                <div class="manufacturer-container swiper-container">
                    <div class="swiper-wrapper">
                        {% for image in about.gallery %}
                        <div class="swiper-slide">
                            <div class="manufacturer__item">
                                <img src="{{ url_for('common.download_file', name=image.photo) }}" alt="alt">
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <!-- Add Arrows -->
                    <div class="wrap">
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script src="{{ url_for('static', filename='admin/plugins/jquery/jquery.min.js') }}"></script>
<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
<script src="{{ url_for('static', filename='public/js/render_items.js') }}"></script>
<script>
const SCRIPT_ROOT = {{ request.url_root | tojson }};
const url = `${SCRIPT_ROOT}/shop_api`;
let manager = new ProductManager(url);
manager.renderItems(initSwiper);

var swiper;

function initSwiper() {
    return new Swiper('.products-container', {
        slidesPerView: 1,
        spaceBetween: 30,
        loop: true,
        speed: 400,
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        autoplay: 10000000,
        zoom: true,
        noSwiping: false,
        breakpoints: {
            1024: {
                slidesPerView: 1,
                spaceBetween: 30,
            },
            920: {
                slidesPerView: 1,
                spaceBetween: 30,
            },
            578: {
                slidesPerView: 1,
                spaceBetween: 10,
            }
        },
        observer: true,
        observeParents: true
    })
}

$(document).ready(function() {
    swiper = initSwiper();

    $('html, body').animate({
        scrollTop: $('.items_row').offset().top
    }, 'slow');

    $('#more_items').on('click', function() {
        this.blur();

        let data = {
            'product_status': $('#product_status').find(':selected').val(),
            'weight': $('#weight').find(':selected').val(),
            'price_up': $('#price_up').prop('checked'),
            'price_down': $('#price_down').prop('checked')
        }

        manager.current_page = ++manager.current_page;
        manager.renderItems(initSwiper, data);
    })
    

    $('#confirm_filter').on('click', function(){
        this.blur();
        let data = {
            'product_status': $('#product_status').find(':selected').val(),
            'weight': $('#weight').find(':selected').val(),
            'price_up': $('#price_up').prop('checked'),
            'price_down': $('#price_down').prop('checked')
        }
        $('.items_row').find('.col-lg-4.col-md-6.col-12').not('.product_base').remove();
        manager.current_page = 1;
        manager.renderItems(initSwiper, data);
    })
})

</script>
<script>
$('#icons-arrow-down').on('click', function() {
    $('#price_down').attr('checked', 'true');
    $('#price_up').removeAttr('checked');

    $(this).css('font-size', '20px').addClass('accent');
    $('#icons-right-top').css('font-size', '12.5px').removeClass('accent');

})
$('#icons-right-top').on('click', function() {
    $('#price_up').attr('checked', 'true');
    $('#price_down').removeAttr('checked', 'false');

    $(this).css('font-size', '20px').addClass('accent');
    $('#icons-arrow-down').css('font-size', '12.5px').removeClass('accent');
})

</script>
{% endblock %}